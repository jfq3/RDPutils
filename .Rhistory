diffs
diffs <- temp1==temp2
diffs
table(diffs)
identical(temp1, temp2)
abc <- colSums(my.otu)
class(abc)
length(abc)
abc[1:6]
assoc.table.fasta[,4][1:6]
def <- assoc.table.fasta[,4]
class(def)
names(def) <- names(abc)
identical(abc, def)
uname(abc)
names(abc <- NULL)
names(def) <- NULL
abc <- colSums(my.otu)
names(abc) <- NULL
abc <- def
setwd("setwd("C:/compare otu methods/HPCC")")
library(RDPutils)
# Unsupervised method (clustering).
setwd("setwd("C:/compare otu methods/HPCC")
# Unsupervised method (clustering).
setwd("C:/compare otu methods/HPCC")
my.otu <- clstr2otu(clstr_file="all_seq_complete.clust", dist=0.03, OutFile=TRUE, file.name= "dist_03.clust")
my.otu[ , 1:5]
my.otu <- clstr2otu(clstr_file="all_seq_complete.clust", dist=0.03, OutFile=TRUE, file.name= "dist_03.clust")
my.otu[ , 1:5]
rep.seqs <- get_repseq_IDs_from_fasta(repseq_file = "all_seq_complete.clust_rep_seqs.fasta")
rep.seqs[1:20]
# Then make the association table, first by parsing the cluster file:
assoc.table.clstr <- assoc_repseq_IDs_with_otus(clstr_file="dist_03.clust", rep_seqs=rep.seqs)
head(assoc.table.clstr)
# Then make the association table by parsing the fasta file IDs:
assoc.table.fasta <- assoc_repseq_IDs_with_clstrs_from_fasta(repseq_file="all_seq_complete.clust_rep_seqs.fasta")
head(assoc.table.fasta)
source('C:/compare otu methods/HPCC/assoc_repseq_IDs_with_clstrs_from_fasta.R')
assoc.table.fasta <- assoc_repseq_IDs_with_clstrs_from_fasta(repseq_file="all_seq_complete.clust_rep_seqs.fasta")
head(assoc.table.fasta)
head(assoc.table.clstr)
assoc.table.clstr <- assoc.table.clstr[order(assoc.table.clstr[,3])]
assoc.table.fasta <- assoc.table.fasta[order(assoc.table.fasta[,3])]
identical(assoc.table.clstr[,1:3], assoc.table.fasta[,1:3])
assoc.table.clstr[,3]
assoc.table.fasta[,3]
assoc.table.clstr <- assoc.table.clstr[order(assoc.table.clstr[,3])]
assoc.table.clstr <- assoc.table.clstr[order(assoc.table.clstr[,3]),]
assoc.table.fasta <- assoc.table.fasta[order(assoc.table.fasta[,3]),]
identical(assoc.table.clstr[,1:3], assoc.table.fasta[,1:3])
assoc.table.clstr[,1:3]
assoc.table.fasta[,1:3]
assoc.table.clstr[,1:3]
assoc.table.fasta[,1:3]
identical(assoc.table.clstr[,1:3], assoc.table.fasta[,1:3])
class(assoc.table.clstr[,3])
class(assoc.table.clstr[,1])
class(assoc.table.clstr[,2])
class(assoc.table.clstr[,4])
class(assoc.table.clstr[,5])
head(assoc.table.clstr)
class(assoc.table.fasta[,1])
class(assoc.table.fasta[,2])
class(assoc.table.fasta[,3])
class(assoc.table.fasta[,4])
head(assoc.table.fasta)
head(assoc.table.clstr)
assoc.table.clstr[] <- lapply(assoc.table.clstr, "character")
assoc.table.clstr[] <- lapply(assoc.table.clstr, as.character)
assoc.table.clstr[i] <- lapplu(assoc.table.clstr[i], as.numeric)
assoc.table.clstr[i] <- lapply(assoc.table.clstr[i], as.numeric)
i <- c("FALSE", "FASLE", "TRUE", "FALSE", "TRUE")
assoc.table.clstr[i] <- lapply(assoc.table.clstr[i], as.numeric)
i <- c("FALSE", "FALSE", "TRUE", "FALSE", "TRUE")
assoc.table.clstr[i] <- lapply(assoc.table.clstr[i], as.numeric)
i <- c("FALSE", "FALSE", "TRUE", "FALSE", "TRUE")
assoc.table.clstr[i] <- lapply(assoc.table.clstr[i], as.numeric)
i <- c("FALSE", "FALSE", "TRUE", "FALSE", "TRUE")
assoc.table.clstr[i] <- lapply(assoc.table.clstr[i], as.numeric)
head(assoc.table.clstr)
assoc.table.clstr <- assoc_repseq_IDs_with_otus(clstr_file="dist_03.clust", rep_seqs=rep.seqs)
head(assoc.table.clstr)
assoc.table.clstr[] <- lapply(assoc.table.clstr{}, as.character)
i <- c("FALSE", "FALSE", "TRUE", "FALSE", "TRUE")
assoc.table.clstr[i] <- lapply(assoc.table.clstr[i], as.numeric)
assoc.table.clstr[] <- lapply(assoc.table.clstr[] as.character)
assoc.table.fasta <- assoc_repseq_IDs_with_clstrs_from_fasta(repseq_file="all_seq_complete.clust_rep_seqs.fasta")
head(assoc.table.fasta)
# Make sure they are in the same column order.
assoc.table.clstr <- assoc.table.clstr[order(assoc.table.clstr[,3]),]
assoc.table.fasta <- assoc.table.fasta[order(assoc.table.fasta[,3]),]
identical(assoc.table.clstr[,1:3], assoc.table.fasta[,1:3])
assoc.table.clstr[] <- lapply(assoc.table.clstr[] as.character)
i <- c("FALSE", "FALSE", "TRUE", "FALSE", "TRUE")
assoc.table.clstr[i] <- lapply(assoc.table.clstr[i], as.numeric)
assoc.table.clstr[] <- lapply(assoc.table.clstr[], as.character)
i <- c("FALSE", "FALSE", "TRUE", "FALSE", "TRUE")
assoc.table.clstr[i] <- lapply(assoc.table.clstr[i], as.numeric)
assoc.table.clstr <- assoc_repseq_IDs_with_otus(clstr_file="dist_03.clust", rep_seqs=rep.seqs)
head(assoc.table.clstr)
assoc.table.clstr[] <- lapply(assoc.table.clstr[], as.character)
i <- c("FALSE", "FALSE", "TRUE", "FALSE", "TRUE")
assoc.table.clstr[i] <- lapply(assoc.table.clstr[i], as.numeric)
i
i <- c(FALSE, FALSE, TRUE, FALSE, TRUE)
assoc.table.clstr[i] <- lapply(assoc.table.clstr[i], as.numeric)
identical(assoc.table.clstr[,1:3], assoc.table.fasta[,1:3])
class(assoc.table.clstr[,1])
class(assoc.table.clstr[,2])
class(assoc.table.clstr[,3])
class(assoc.table.fasta[,1])
class(assoc.table.fasta[,2])
class(assoc.table.fasta[,3])
assoc.table.clstr <- assoc.table.clstr[order(assoc.table.clstr[,3]),]
assoc.table.fasta <- assoc.table.fasta[order(assoc.table.fasta[,3]),]
identical(assoc.table.clstr[,1:3], assoc.table.fasta[,1:3])
head(assoc.table.clstr)
identical(assoc.table.clstr[,1], assoc.table.fasta[,1])
assoc.table.clstr <- assoc.table.clstr[order(assoc.table.clstr[,3]),]
assoc.table.fasta <- assoc.table.fasta[order(assoc.table.fasta[,3]),]
identical(assoc.table.clstr[,1:3], assoc.table.fasta[,1:3]) # FALSE
identical(assoc.table.clstr[,1:3], assoc.table.fasta[,1:3]) # FALSE
assoc.table.clstr[] <- lapply(assoc.table.clstr[], as.character)
i <- c(FALSE, FALSE, TRUE, FALSE, TRUE)
assoc.table.clstr[i] <- lapply(assoc.table.clstr[i], as.numeric)
identical(assoc.table.clstr[,1:3], assoc.table.fasta[,1:3]) # Still FALSE
identical(assoc.table.clstr[,2], assoc.table.fasta[,2])
identical(assoc.table.clstr[,1], assoc.table.fasta[,3])
identical(assoc.table.clstr[,1], assoc.table.fasta[,1])
identical(assoc.table.clstr[,2], assoc.table.fasta[,2])
identical(assoc.table.clstr[,1], assoc.table.fasta[,3])
source('C:/compare otu methods/HPCC/assoc_repseq_IDs_with_clstrs_from_fasta.R')
assoc.table.fasta <- assoc_repseq_IDs_with_clstrs_from_fasta(repseq_file="all_seq_complete.clust_rep_seqs.fasta")
head(assoc.table.fasta)
class(assoc.table.fasta[.2])
class(assoc.table.fasta[,2])
class(assoc.table.fasta[,1])
class(assoc.table.fasta[,3])
class(assoc.table.fasta[,4])
# Make sure they are in the same column order.
assoc.table.clstr <- assoc.table.clstr[order(assoc.table.clstr[,3]),]
assoc.table.fasta <- assoc.table.fasta[order(assoc.table.fasta[,3]),]
identical(assoc.table.clstr[,1:3], assoc.table.fasta[,1:3]) # FALSE
head(assoc.table.clstr)
head(assoc.table.fasta)
temp <- colnames(assoc.table.fasta)
fix(temp)
colnames(assoc.table.fasta) <- temp
identical(assoc.table.clstr[,1:3], assoc.table.fasta[,1:3]) # FALSE
assoc.table.clstr[] <- lapply(assoc.table.clstr[], as.character)
i <- c(FALSE, FALSE, TRUE, FALSE, TRUE)
assoc.table.clstr[i] <- lapply(assoc.table.clstr[i], as.numeric)
identical(assoc.table.clstr[,1:3], assoc.table.fasta[,1:3]) # Still FALSE
head(assoc.table.fasta)
head(assoc.table.clstr)
source('C:/compare otu methods/HPCC/assoc_repseq_IDs_with_clstrs_from_fasta.R')
# Then make the association table by parsing the fasta file IDs:
assoc.table.fasta <- assoc_repseq_IDs_with_clstrs_from_fasta(repseq_file="all_seq_complete.clust_rep_seqs.fasta")
head(assoc.table.fasta)
source('C:/compare otu methods/HPCC/assoc_repseq_IDs_with_clstrs_from_fasta.R')
assoc.table.fasta <- assoc_repseq_IDs_with_clstrs_from_fasta(repseq_file="all_seq_complete.clust_rep_seqs.fasta")
head(assoc.table.fasta)
assoc.table.clstr <- assoc.table.clstr[order(assoc.table.clstr[,3]),]
assoc.table.fasta <- assoc.table.fasta[order(assoc.table.fasta[,3]),]
identical(assoc.table.clstr[,1:3], assoc.table.fasta[,1:3]) # FALSE
assoc.table.clstr <- assoc_repseq_IDs_with_otus(clstr_file="dist_03.clust", rep_seqs=rep.seqs)
head(assoc.table.clstr)
assoc.table.fasta <- assoc_repseq_IDs_with_clstrs_from_fasta(repseq_file="all_seq_complete.clust_rep_seqs.fasta")
head(assoc.table.fasta)
identical(assoc.table.clstr[,1:3], assoc.table.fasta[,1:3]) # TRUE
assoc.table.clstr <- assoc.table.clstr[order(assoc.table.clstr[,3]),]
assoc.table.fasta <- assoc.table.fasta[order(assoc.table.fasta[,3]),]
identical(assoc.table.clstr[,1:3], assoc.table.fasta[,1:3]) # TRUE
class(assoc.table.clstr[,2])
class(assoc.table.fasta[,2])
class(assoc.table.fasta[,1:3])
class(assoc.table.clstr[,1])
class(assoc.table.clstr[,2])
class(assoc.table.clstr[,3])
class(assoc.table.fasta[,1])
class(assoc.table.fasta[,2])
class(assoc.table.fasta[,3])
class(assoc.table.fasta[,4])
class(assoc.table.clstr[,1])
class(assoc.table.clstr[,2])
class(assoc.table.clstr[,3])
class(assoc.table.clstr[,4])
class(assoc.table.clstr[,5])
i <- c(F,T,F,F,F)
i
assoc.table.clstr[i] <- lapply(assoc.table.clstr[i], as.chaaracter)
assoc.table.clstr[i] <- lapply(assoc.table.clstr[i], as.character)
identical(assoc.table.clstr[,1:3], assoc.table.fasta[,1:3]) # FALSE
library(RDPutils)
source('C:/compare otu methods/HPCC/assoc_repseq_ID_fasta.R')
library(RDPutils)
setwd("C:/compare otu methods/HPCC")
my.otu <- clstr2otu(clstr_file="all_seq_complete.clust", dist=0.03, OutFile=TRUE, file.name= "dist_03.clust")
my.otu[ , 1:5]
rep.seqs <- get_repseq_IDs_from_fasta(repseq_file = "all_seq_complete.clust_rep_seqs.fasta")
rep.seqs[1:20]
assoc.table.clstr <- assoc_repseq_IDs_with_otus(clstr_file="dist_03.clust", rep_seqs=rep.seqs)
head(assoc.table.clstr)
assoc.table.fasta <- assoc_repseq_IDs_with_clstrs_from_fasta(repseq_file="all_seq_complete.clust_rep_seqs.fasta")
head(assoc.table.fasta)
source('C:/compare otu methods/HPCC/assoc_repseq_ID_with_clstr_no_from_fasta.R')
assoc.table.fasta <- assoc_repseq_IDs_with_clstrs_from_fasta(repseq_file="all_seq_complete.clust_rep_seqs.fasta")
head(assoc.table.fasta)
source('C:/compare otu methods/HPCC/assoc_repseq_IDs_with_clstrs_from_fasta.R')
assoc.table.fasta <- assoc_repseq_IDs_with_clstrs_from_fasta(repseq_file="all_seq_complete.clust_rep_seqs.fasta")
head(assoc.table.fasta)
# Make sure they are in the same column order.
assoc.table.clstr <- assoc.table.clstr[order(assoc.table.clstr[,3]),]
assoc.table.fasta <- assoc.table.fasta[order(assoc.table.fasta[,3]),]
identical(assoc.table.clstr[,1:3], assoc.table.fasta[,1:3]) # FALSE
class(assoc.table.clstr[,1])
class(assoc.table.clstr[,2])
class(assoc.table.clstr[,3])
class(assoc.table.clstr[,4])
class(assoc.table.clstr[,5])
class(assoc.table.fasta[,1])
class(assoc.table.fasta[,2])
class(assoc.table.fasta[,3])
class(assoc.table.fasta[,4])
i <- c(F,T,F,F,F)
i
assoc.table.clstr[i] <- lapply(assoc.table.clstr[i], as.character)
identical(assoc.table.clstr[,1:3], assoc.table.fasta[,1:3]) # FALSE
head(assoc.table.clstr)
head(assoc.table.fasta)
library(RDPutils)
source('C:/compare otu methods/HPCC/assoc_repseq_ID_fasta.R')
my.otu <- clstr2otu(clstr_file="all_seq_complete.clust", dist=0.03, OutFile=TRUE, file.name= "dist_03.clust")
my.otu[ , 1:5]
setwd("C:/compare otu methods/HPCC")
my.otu <- clstr2otu(clstr_file="all_seq_complete.clust", dist=0.03, OutFile=TRUE, file.name= "dist_03.clust")
my.otu[ , 1:5]
rep.seqs <- get_repseq_IDs_from_fasta(repseq_file = "all_seq_complete.clust_rep_seqs.fasta")
rep.seqs[1:20]
assoc.table.clstr <- assoc_repseq_IDs_with_otus(clstr_file="dist_03.clust", rep_seqs=rep.seqs)
head(assoc.table.clstr)
assoc.table.fasta <- assoc_repseq_IDs_with_clstrs_from_fasta(repseq_file="all_seq_complete.clust_rep_seqs.fasta")
head(assoc.table.fasta)
rm(make_otu_names
)
rm(assoc_repseq_ID_fasta)
source('C:/compare otu methods/HPCC/assoc_repseq_ID_with_clstr_no_from_fasta.R')
assoc.table.fasta <- assoc_repseq_IDs_with_clstrs_from_fasta(repseq_file="all_seq_complete.clust_rep_seqs.fasta")
head(assoc.table.fasta)
rm(assoc_repseq_with_clstr_no_from_fasta)
rm(assoc_repseq_with_clstr_no_from_fasta)
rm(make_otu_names)
source('C:/compare otu methods/HPCC/assoc_repseq_IDs_with_clstrs_from_fasta.R')
assoc.table.fasta <- assoc_repseq_IDs_with_clstrs_from_fasta(repseq_file="all_seq_complete.clust_rep_seqs.fasta")
head(assoc.table.fasta)
head(assoc.table.clstr)
identical(assoc.table.clstr[,1:3], assoc.table.fasta[,1:3]) # FALSE
assoc.table.clstr <- assoc.table.clstr[order(assoc.table.clstr[,3]),]
assoc.table.fasta <- assoc.table.fasta[order(assoc.table.fasta[,3]),]
identical(assoc.table.clstr[,1:3], assoc.table.fasta[,1:3]) # FALSE
my.otu <- clstr2otu(clstr_file="all_seq_complete.clust", dist=0.03, OutFile=TRUE, file.name= "dist_03.clust")
my.otu[ , 1:5]
# First get machine names of the representative sequences:
# By parsing fasta IDs:
rep.seqs <- get_repseq_IDs_from_fasta(repseq_file = "all_seq_complete.clust_rep_seqs.fasta")
rep.seqs[1:20]
# Then make the association table, first by parsing the cluster file:
assoc.table.clstr <- assoc_repseq_IDs_with_otus(clstr_file="dist_03.clust", rep_seqs=rep.seqs)
head(assoc.table.clstr)
# Then make the association table by parsing the fasta file IDs:
assoc.table.fasta <- assoc_repseq_IDs_with_clstrs_from_fasta(repseq_file="all_seq_complete.clust_rep_seqs.fasta")
head(assoc.table.fasta)
# Make sure they are in the same column order.
assoc.table.clstr <- assoc.table.clstr[order(assoc.table.clstr[,3]),]
assoc.table.fasta <- assoc.table.fasta[order(assoc.table.fasta[,3]),]
identical(assoc.table.clstr[,1:3], assoc.table.fasta[,1:3]) # FALSE
source('C:/compare otu methods/HPCC/assoc_repseq_IDs_with_clstrs_from_fasta.R')
source('C:/compare otu methods/HPCC/assoc_repseq_IDs_with_clstrs_from_fasta.R')
assoc.table.fasta <- assoc_repseq_IDs_with_clstrs_from_fasta(repseq_file="all_seq_complete.clust_rep_seqs.fasta")
head(assoc.table.fasta)
# Make sure they are in the same column order.
assoc.table.clstr <- assoc.table.clstr[order(assoc.table.clstr[,3]),]
assoc.table.fasta <- assoc.table.fasta[order(assoc.table.fasta[,3]),]
identical(assoc.table.clstr[,1:3], assoc.table.fasta[,1:3]) # FALSE
source('C:/compare otu methods/HPCC/assoc_repseq_IDs_with_clstrs_from_fasta.R')
source('C:/compare otu methods/HPCC/assoc_repseq_IDs_with_clstrs_from_fasta.R')
source('C:/compare otu methods/HPCC/assoc_repseq_IDs_with_clstrs_from_fasta.R')
my.otu <- clstr2otu(clstr_file="all_seq_complete.clust", dist=0.03, OutFile=TRUE, file.name= "dist_03.clust")
my.otu[ , 1:5]
rep.seqs <- get_repseq_IDs_from_fasta(repseq_file = "all_seq_complete.clust_rep_seqs.fasta")
rep.seqs[1:20]
#
assoc.table.clstr <- assoc_repseq_IDs_with_otus(clstr_file="dist_03.clust", rep_seqs=rep.seqs)
head(assoc.table.clstr)
source('C:/compare otu methods/HPCC/assoc_repseq_IDs_with_clstrs_from_fasta.R')
assoc.table.fasta <- assoc_repseq_IDs_with_clstrs_from_fasta(repseq_file="all_seq_complete.clust_rep_seqs.fasta")
head(assoc.table.fasta)
assoc.table.clstr <- assoc.table.clstr[order(assoc.table.clstr[,3]),]
identical(assoc.table.clstr[,1:3], assoc.table.fasta[,1:3]) # FALSE
setwd("C:/compare otu methods/rdpipe")
my.otu <- clstr2otu(clstr_file="all_samples.clust", dist=0.03, OutFile=TRUE, file.name= "dist_03.clust")
my.otu[ , 1:5]
rep.seqs <- get_repseq_IDs_from_fasta(repseq_file = "rdpipe_reps_rep_seqs.fasta")
rep.seqs[1:20]
assoc.table.clstr <- assoc_repseq_IDs_with_otus(clstr_file="dist_03.clust", rep_seqs=rep.seqs)
head(assoc.table.clstr)
assoc.table.fasta <- assoc_repseq_IDs_with_clstrs_from_fasta(repseq_file="rdpipe_reps_rep_seqs.fasta")
head(assoc.table.fasta)
source('C:/compare otu methods/rdpipe/assoc_repseq_IDs_with_clstrs_from_fasta.R')
source('C:/compare otu methods/rdpipe/assoc_repseq_IDs_with_clstrs_from_fasta.R')
source('C:/compare otu methods/rdpipe/assoc_repseq_IDs_with_clstrs_from_fasta.R')
assoc.table.fasta <- assoc_repseq_IDs_with_clstrs_from_fasta(repseq_file="rdpipe_reps_rep_seqs.fasta")
head(assoc.table.fasta)
# Make sure they are in the same column order.
assoc.table.clstr <- assoc.table.clstr[order(assoc.table.clstr[,3]),]
assoc.table.fasta <- assoc.table.fasta[order(assoc.table.fasta[,3]),]
identical(assoc.table.clstr[,1:3], assoc.table.fasta[,1:3]) # TRUE
library(RDPutils)
library(RDPutils)
setwd("C:/compare otu methods/HPCC")
test.hpcc.format <- test_new_assoc_fasta()
head(test.hpcc.format)
otu.hpcc <- clstr2otu(clstr_file="dist_03.clust")
otu.hpcc <- otu.hpcc[ ,order(colnames(otu.hpcc))]
identical(unname(colSums(otu.hpcc)), test.hpcc.format[,4])
identical(colnames(otu.hpcc), test.hpcc.format[,2])
sum(test.hpcc.format[,4])==sum(otu.rdpipe)
test.hpcc.format <- assoc_repseq_IDs_with_otus_by_fasta(repseq_file="all_seq_complete.clust_rep_seqs.fasta")
otu.hpcc <- clstr2otu(clstr_file="dist_03.clust")
otu.hpcc <- otu.hpcc[ ,order(colnames(otu.hpcc))]
identical(unname(colSums(otu.hpcc)), test.hpcc.format[,4])
identical(colnames(otu.hpcc), test.hpcc.format[,2])
sum(test.hpcc.format[,4])==sum(otu.rdpipe)
sum(test.hpcc.format[,4])==sum(otu.hpcc)
setwd("C:/compare otu methods/rdpipe")
test.rdpipe.format <- assoc_repseq_IDs_with_otus_by_fasta("rdpipe_reps_rep_seqs.fasta")
head(test.rdpipe.format)
otu.rdpipe <- clstr2otu(clstr_file="dist_03.clust")
otu.rdpipe <- otu.rdpipe[ ,order(colnames(otu.rdpipe))]
identical(unname(colSums(otu.rdpipe)), test.rdpipe.format[,4])
identical(colnames(otu.rdpipe), test.rdpipe.format[,2])
sum(test.rdpipe.format[,4])==sum(otu.rdpipe)
rep.seq.file <- system.file("extdata", "all_seq_complete.clust_rep_seqs.fasta", package="RDPutils")
assoc.table <- assoc_repseq_IDs_with_otus_by_fasta(repseq_file)
head(assoc.table)
rm(assoc.table)
rep.seq.file <- system.file("extdata", "all_seq_complete.clust_rep_seqs.fasta", package="RDPutils")
assoc.table <- assoc_repseq_IDs_with_otus_by_fasta(repseq_file)
head(assoc.table)
rep.seq.file <- system.file("extdata", "all_seq_complete.clust_rep_seqs.fasta", package="RDPutils")
library(RDPutils)
library(RDPutils)
library(RDPutils)
library(RDPutils)
setwd("C:/compare otu methods/HPCC")
test.hpcc.format <- assoc_repseq_IDs_with_otus_by_fasta(repseq_file="all_seq_complete.clust_rep_seqs.fasta")
head(test.hpcc.format)
otu.hpcc <- clstr2otu(clstr_file="dist_03.clust")
otu.hpcc <- otu.hpcc[ ,order(colnames(otu.hpcc))]
identical(unname(colSums(otu.hpcc)), test.hpcc.format[,4])
identical(colnames(otu.hpcc), test.hpcc.format[,2])
sum(test.hpcc.format[,4])==sum(otu.hpcc)
library(RDPutils)
setwd("C:/compare otu methods/HPCC")
test.hpcc.format <- assoc_repseq_IDs_with_otus_by_fasta(repseq_file="all_seq_complete.clust_rep_seqs.fasta")
head(test.hpcc.format)
otu.hpcc <- clstr2otu(clstr_file="dist_03.clust")
otu.hpcc <- otu.hpcc[ ,order(colnames(otu.hpcc))]
identical(unname(colSums(otu.hpcc)), test.hpcc.format[,4])
identical(colnames(otu.hpcc), test.hpcc.format[,2])
sum(test.hpcc.format[,4])==sum(otu.hpcc)
setwd("C:/compare otu methods/rdpipe")
test.rdpipe.format <- assoc_repseq_IDs_with_otus_by_fasta("rdpipe_reps_rep_seqs.fasta")
head(test.rdpipe.format)
otu.rdpipe <- clstr2otu(clstr_file="dist_03.clust")
otu.rdpipe <- otu.rdpipe[ ,order(colnames(otu.rdpipe))]
identical(unname(colSums(otu.rdpipe)), test.rdpipe.format[,4])
identical(colnames(otu.rdpipe), test.rdpipe.format[,2])
sum(test.rdpipe.format[,4])==sum(otu.rdpipe)
data(assoc.table)
head(assoc.table)
my.in.file <- system.file("extdata", "fixrank_classified.txt", package="RDPutils")
my.tax.table <- make_tax_table(in_file = my.in.file, confidence=0.5)
my.tax.table
library(RDPutils)
my.in.file <- system.file("extdata", "fixrank_classified.txt", package="RDPutils")
my.tax.table <- make_tax_table(in_file = my.in.file, confidence=0.5)
my.tax.table
identical(otu, rdp.otu)
identical(otu, otu.rdp)
rformatfile <- system.file("extdata", "rformat_dist_0.03.txt",
package="RDPutils")
otu.rdp <- read.table(rformatfile, header=TRUE, row.names=1, sep="\t")
identical(otu, otu.rdp)
otu.rdp <- otu.rdp[sort(rownames(otu.rdp)), ]
identical(otu, otu.rdp)
class(otu[,1])
class(otu.rdp[,1])
identical(as.integer(otu), otu.rdp)
class(otu)
class(otu.rdp)
otu.rdp[] <- lapply(otu.rdp[], as.numeric)
identical(otu, oru.rdp)
identical(otu, otu.rdp)
sum(otu)
sum(otu.rdp)
getwd()
repseq.file <- system.file("ext.data",
"all_seq_complete.clust_rep_seqs.fasta",
package="RDPutils")
assoc.table <- assoc_repseq_IDs_with_otus_by_fasta(repseq_file=)
head(assoc.table)
repseq.file <- system.file("ext.data",
"all_seq_complete.clust_rep_seqs.fasta",
package="RDPutils")
library(RDPutils)
repseq.file <- system.file("ext.data",
"all_seq_complete.clust_rep_seqs.fasta",
package="RDPutils")
repseq.file <- system.file("extdata", "all_seq_complete.clust_rep_seqs.fasta", package="RDPutils")
assoc.table <- assoc_repseq_IDs_with_otus_by_fasta(repseq_file=repseq.file)
head(assoc.table)
getwd()
dir()
getwd()
repseq.file <- system.file("extdata",
"all_seq_complete.clust_rep_seqs.fasta",
package="RDPutils")
rep.seqs <- get_repseq_IDs_from_fasta(repseq_file = repseq.file)
clstr <- system.file("extdata", "dist_03.clust", package="RDPutils")
assoc.table <- assoc_repseq_IDs_with_otus_by_clstr(clstr_file=clstr,
rep_seqs=rep.seqs)
head(assoc.table
library(RDPutils)
hier.file <- system.file("extdata", "test_hier.txt", package="hier")
expt <- hier2phyloseq(hier_file=hier.file)
expt
unique(tax_table(expt)[ ,"domain"])
fungi <- subset_taxa(expt, domain=="Fungi")
fungi
ntaxa(expt)
sum(expt)
sum(otu_table(expt))
rank_names(expt)
expt.sum <- sum(otu_table(expt))
fungi.sum <- sum(otu_table(fung))
100*((expt.sum-fungi.sum)/expt.sum)
fungi.sum <- sum(otu_table(fungi))
100*((expt.sum-fungi.sum)/expt.sum)
setwd("C:/R_My_Packages/RDPutils/data")
load(assoc.table.rda)
load("assoc.table.rda")
head(data)
head(assoc.table)
data
library(RDPutils)
hier.file <- system.file("extdata", "test_hier.txt", package="hier")
expt <- hier2phyloseq(hier_file=hier.file)
expt
fungi <- subset_taxa(expt, domain=="Fungi")
fungi
tax_table(fungi)
head(tax_table(fungi))
tax_table(fungi)
n <- c(1:10)
otu.names <- make_otu_names(n)
otu.names
my.in.file <- system.file("extdata", "fixrank_classified.txt", package="RDPutils")
my.tax.table <- make_tax_table(in_file = my.in.file, confidence=0.5)
my.tax.table
data(sam.data)
str(sam.data)
plot(sam.data)
data
sam.data
getwd()
setwd("c:/test")
cols
cols <- c(T, T, F, F)
cols
sam.data[cols] <- lapply(sam.data[cols], as.factor)
str(sam.data)
save(sam.data, file="sam.data.rda")
rm(sam.data)
data(sam.data)
sam.data
library(RDPutils)
help(RDPutils)
install.packages("C:/R_My_Packages/RDPutils_1.0.tar.gz", repos = NULL, type = "source")
my.in.file <- system.file("extdata", "fixrank_classified.txt", package="RDPutils")
my.tax.table <- make_tax_table(in_file = my.in.file, confidence=0.5)
head(my.tax.table)
install.packages("C:/R_My_Packages/RDPutils_1.0.tar.gz", repos = NULL, type = "source")
library(RDPutils)
library("RDPutils", lib.loc="C:/Users/John Q/Documents/R/win-library/3.1")
getwd()
data(sam.data)
sam.data
data(rep.tree)
rep.tree <- system.file("extdaya", "rep.tree.nwk", package="RDPutils")
my.tree <- read_tree(rep.tree)
my.otu <- otu_table(as.matrix(t(otu)), taxaAreRows=TRUE, errorIfNULL=TRUE)
my.data <- sample_data(sam.data)
myexpt <- phyloseq(my.otu, my.tax.table, my.data, my.tree)
my.expt
library(RDPutils)
install.packages("C:/R_My_Packages/RDPutils_1.0.tar.gz", repos = NULL, type = "source")
install.packages("C:/R_My_Packages/RDPutils_1.0.tar.gz", repos = NULL, type = "source")
library("RDPutils", lib.loc="C:/Users/John Q/Documents/R/win-library/3.1")
library(RDPutils)
library(RDPutils)
